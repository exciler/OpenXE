import{c as p,p as g,r as y,o as T,q as x,j as w}from"../vue-r8MBkmxb.js";import{_ as m}from"../ClickByClickAssistant.vue_vue_type_script_setup_true_lang-BsVWj7ri.js";import{a as l}from"../axios-Cm0UX6qg.js";import{A as k}from"../ajaxErrorHandler-BwWU8vup.js";import"../vee-validate.esm-B8KWITsB.js";import"../_plugin-vue_export-helper-DlAUqK2U.js";const u="#onlineshop-appnew-error",c="#onlineshop-appnew",S="#onlineshop-appnewjson";function b(){var t;const e={showAssistant:!0,pagination:!0,allowClose:!0,pages:[{type:"defaultPage",icon:"password-icon",headline:"Request ung√ºltig",subHeadline:(t=document.querySelector(u))==null?void 0:t.dataset.errormsg,ctaButtons:[{title:"OK",action:"close"}]}]};p(m,e).mount(u)}function _(){const e={showAssistant:!0,pagination:!0,allowClose:!0,pages:[{type:"form",dataRequiredForSubmit:{data:JSON.stringify(document.querySelector(c).dataset.appnewdata)},submitType:"submit",submitUrl:"index.php?module=onlineshops&action=appnew&cmd=createdata",headline:document.querySelector(c).dataset.heading,subHeadline:document.querySelector(c).dataset.info,form:[{id:0,name:"create-shop",inputs:[{type:"select",name:"shopId",label:"Auswahl",validation:!0,options:JSON.parse(document.querySelector(S).innerHTML)}]}],ctaButtons:[{title:"Weiter",type:"submit",action:"submit"}]}]};p(m,e).mount(c)}document.querySelector(u)&&b();document.querySelector(c)&&_();document.querySelector("#frmappnew")&&(document.querySelector("#data").addEventListener("paste",function(e){l.post("index.php?module=onlineshops&action=appnew&cmd=checkdata",{data:e.originalEvent.clipboardData.getData("text")}).then(function(t){document.querySelector("#msgwrapper").innerHTML=t.data}).catch(function(t){t.response.data.error&&(document.querySelector("#msgwrapper").innerHTML='<div class="error">'+t.response.data.error+"</div>")})}),document.querySelector("#data").addEventListener("change",function(){l.post("index.php?module=onlineshops&action=appnew&cmd=checkdata",{data:this.value}).then(function(e){document.querySelector("#msgwrapper").innerHTML=e.data}).catch(function(e){e.response.data.error&&(document.querySelector("#msgwrapper").innerHTML='<div class="error">'+e.response.data.error+"</div>")})}));var C=function(e){var t={storage:{exampleTemplate:null,treeApi:null,lastTreeSearch:""},openTransformationPopup:function(){e("#textareasmartyincomming").val(e("#transform_cart").val()),e("#textareasmartyincomminginput").val(e("#textareasmartyincomminginput").val())},loadCart:function(n){e("#cart").val()+""!=""&&e.ajax({type:"POST",url:"index.php?module=onlineshops&action=edit&cmd=loadCart",data:{shopid:n,extid:e("#cart").val(),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,content:e("#textareasmartyincomming").val()},success:function(a){e("#textareasmartyincomminginput").val(a.input),e("#dataincommingobject").html(a.object),e("#dataincommingpreview").val(a.preview)}})},initCategoryTree:function(){e("#mlmTree").aciTree({autoInit:!1,checkboxChain:!1,ajax:{url:"index.php?module=onlineshops&action=edit&cmd=loadTree&id="+e("#mlmTree").data("id")},checkbox:!0,multiSelectable:!0,itemHook:function(n,a,r,o){},filterHook:function(n,a,r){if(a.length){var o=this.parent(n);if(o.length){var i=this.getLabel(o);if(r.test(String(i)))return this.setVisible(n),!0;this.setVisible(n)}return r.test(String(this.getLabel(n)))?(n.addClass("searched"),!0):!1}else return!0}}),t.storage.treeApi=e("#mlmTree").aciTree("api"),e("#search").val(""),t.storage.lastTreeSearch="",e("#search").on("keyup",function(){e(this).val()!==t.storage.lastTreeSearch&&(e(".aciTreeLi").removeClass("searched"),t.storage.lastTreeSearch=e(this).val(),api.filter(null,{search:e(this).val(),callback:function(){},success:function(n,a){a.first}}))}),e("#mlmTree").on("acitree",function(n,a,r,o,i){switch(o){case"checked":var d={id:a.getId(r),shopId:e("#mlmTree").data("id"),name:a.getLabel(r),checked:!0,todo:"check"},s=a.getId(r),h=a.children(null,!0,!0);e(h).each(function(){a.getId(e(this))!=s&&a.uncheck(e(this))}),e("#category_root_id").val(s),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=checkTreeNode",data:d,success:function(v){}});break;case"unchecked":var d={id:a.getId(r),shopId:e("#mlmTree").data("id"),name:a.getLabel(r),checked:!1,todo:"uncheck"};e("#category_root_id").val(0),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=uncheckTreeNode",data:d,success:function(v){}});break}}),e("#mlmTree").aciTree("init"),e(window).on("scroll",function(){checkContainerPos()})},initSmarty:function(){e("#editcarttransformation").on("click",function(){t.openTransformationPopup()}),e("#runincomming").on("click",function(){e("#transform_cart").val(e("#textareasmartyincomming").val()),e("#transform_cart_data").val(e("#textareasmartyincomminginput").val()),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=runincomming",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0},success:function(n){e("#dataincommingobject").html(n.object),e("#dataincommingpreview").val(n.preview)}})}),e("#saveincomming").on("click",function(){e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=savesmartyincomming",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,active:e("#transferactive").prop("checked")?"1":"0"},success:function(){e("#transform_cart_format").val(e("#smartyinputtype").val()),e("#transform_cart_replace").val(e("#replacecart").prop("checked")?1:0),e("#transform_cart").val(e("#textareasmartyincomming").val()),e("#transform_cart_data").val(e("#textareasmartyincomminginput").val()),e("#transform_cart_active").val(e("#transferactive").prop("checked")?"1":"0")}})}),e("#transferactive").on("change",function(){e("#transform_cart_active").val(e("#transferactive").prop("checked")?"1":"0")}),e("#smartyinputtype").on("change",function(){t.loadDefaultTemplate()}),t.loadDefaultTemplate(),e("#loadDefaultTemplate").on("click",function(){t.storage.loadDefaultTemplate+""!=""&&((e("#textareasmartyincomming").val()+"").trim()!==""&&!confirm("Das bisherige Template wird ersetzt. Fortfahren?")||e("#textareasmartyincomming").val(t.storage.loadDefaultTemplate))}),e("#loadCart").on("click",function(){var n=e("#cart").val()+"";n!==""&&t.loadCart(e(this).data("shopid"))})},loadDefaultTemplate:function(){t.storage.loadDefaultTemplate="",e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=loadDefaultTemplate",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,active:e("#transferactive").prop("checked")?"1":"0"},success:function(n){typeof n.template<"u"&&n.template!==""?(t.storage.loadDefaultTemplate=n.template,e("#loadDefaultTemplate").toggleClass("hidden",!1),e("#loadDefaultTemplate").show()):(t.storage.loadDefaultTemplate="",e("#loadDefaultTemplate").hide())}})},init:function(){e("#smartyinput").length&&t.initSmarty(),e("#mlmTree").length&&t.initCategoryTree()}};return{init:t.init}}(jQuery);$(document).ready(function(){C.init()});const q=g({__name:"App",setup(e){const t=y(null);document.querySelectorAll(".createbutton").forEach(o=>{o.addEventListener("click",a)});const n=document.querySelector(".autoOpenModule");n&&n.dataset.module&&r(n.dataset.module);function a(o){const i=o.currentTarget.dataset.module;i&&r(i)}function r(o){l.post("index.php?module=onlineshops&action=create&cmd=getassistant",{shopmodule:o},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(i){if(i.data.pages===void 0&&i.data.location!==void 0){window.location=i.data.location;return}t.value=i.data.pages}).catch(k)}return(o,i)=>t.value?(T(),x(m,{key:0,pages:t.value,pagination:"",allowClose:"",onClose:i[0]||(i[0]=s=>t.value=null)},null,8,["pages"])):w("",!0)}});function j(e){const t=e.currentTarget.value,n={headers:{"Content-Type":"application/x-www-form-urlencoded"}};l.post("index.php?module=onlineshops&action=create&cmd=suche",{val:t},n).then(a=>{a.data!==void 0&&a.data!=null&&(a.data.ausblenden!==void 0&&a.data.ausblenden!=null&&a.data.ausblenden.forEach(r=>{const o=document.querySelector("#"+r);o&&(o.style.display="none")}),typeof a.data.anzeigen!==void 0&&a.data.anzeigen!=null&&a.data.anzeigen.forEach(r=>{const o=document.querySelector("#"+r);o&&(o.style.display="flex")}))})}var f;(f=document.querySelector("#suche"))==null||f.addEventListener("keyup",j);p(q,{}).mount("#onlineshop-create");
