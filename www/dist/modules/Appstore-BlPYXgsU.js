$(document).ready(function(){$("body").addClass("module-appstore");var n={storage:{}};n.search=$("#appstore-search"),n.categoryPage=$(".category-page"),n.categoryBlock=$(".appstore-categories"),n.popularBlock=$(".popular"),n.categoryBack=$(".category-page-back"),n.tabs=$("span.appstore-tab"),n.activePhrase="",n.activeCategory="",$("#modulesJson").length>0&&(n.storage.apps=JSON.parse($("#modulesJson").html())),n.tabs.on("click touch",function(){var t=$(this);n.tabs.removeClass("appstore-tab-active"),t.addClass("appstore-tab-active"),l(t.data("filter"))}),n.categoryBack.on("click touch",function(){window.history.back()}),n.categoryPage.length>0&&$("#appstore .popular").hide();function l(t){var i=$("#appstore .overview"),e=i.find(".popular"),a=i.find(".available-apps");t==="installed"&&(e.hide(),a.hide()),t==="all"&&(e.show(),a.children().length>0&&a.show()),n.categoryPage.length>0&&e.hide()}n.search.on("keyup",function(){n.activePhrase=$(this).val(),r(n.activePhrase,n.activeCategory,n.categoryBlock,n.popularBlock)}),$(".dropdown").each(function(){var t=$(this),i=t.children("a.dropdown-link"),e=t.find("a.dropdown-sublink"),a=i.children(".caret");a.on("click",function(s){s.preventDefault(),t.toggleClass("open")}),i.on("focusout",function(){setTimeout(function(){t.removeClass("open")},300)}),i.on("click",function(s){var o=$(this).attr("href");o==="#"&&(t.addClass("open"),s.preventDefault())}),e.on("touchend",function(s){s.preventDefault();var o=$(this).attr("href");o!=="#"&&window.open(o),setTimeout(function(){t.removeClass("open")},300)})}),$("a.activate").on("click",function(t){t.preventDefault(),$.ajax({url:"index.php?module=appstore&action=list&cmd="+($(this).hasClass("deactivate")?"deactivate":"activate"),type:"POST",dataType:"json",data:{module:$(this).data("module")}}).done(function(i){if(typeof i.status<"u"&&i.status==1&&typeof i.module<"u"){var e=$("*").find("[data-module='"+i.module+"']");e.length&&($(e).toggleClass("activate"),$(e).toggleClass("deactivate"),$(e).hasClass("deactivate")?($(e).html("Deaktivieren"),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("deactivated",!1),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("activated",!0)):($(e).html("Aktivieren"),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("deactivated",!0),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("activated",!1)))}else typeof i.error<"u"&&alert($data.error)})}),$("a.deactivate").on("click",function(t){t.preventDefault(),$.ajax({url:"index.php?module=appstore&action=list&cmd="+($(this).hasClass("deactivate")?"deactivate":"activate"),type:"POST",dataType:"json",data:{module:$(this).data("module")}}).done(function(i){if(typeof i.status<"u"&&i.status==1&&typeof i.module<"u"){var e=$("*").find("[data-module='"+i.module+"']");e.length&&($(e).toggleClass("activate"),$(e).toggleClass("deactivate"),$(e).hasClass("deactivate")?($(e).html("Deaktivieren"),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("deactivated",!1),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("activated",!0)):($(e).html("Aktivieren"),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("deactivated",!0),$(e).parents("div.dropdown").first().find("a.dropdown-link").first().toggleClass("activated",!1)))}else typeof i.error<"u"&&alert($data.error)})})});function r(n,l,t,i){$.ajax({url:"index.php?module=appstore&action=list&cmd=suche",type:"POST",dataType:"json",data:{val:n,category:l}}).done(function(e){typeof e>"u"||e===null||(typeof e.ausblenden<"u"&&e.ausblenden!==null&&$.each(e.ausblenden,function(a,s){a!=""&&$("#"+a).hide()}),typeof e.anzeigen<"u"&&e.anzeigen!==null&&$.each(e.anzeigen,function(a,s){a!=""&&$("#"+a).show()}),typeof e.katausblenden<"u"&&e.katausblenden!==null&&$.each(e.katausblenden,function(a,s){a!=""&&$("#"+a).hide()}),typeof e.kateinblenden<"u"&&e.kateinblenden!==null&&$.each(e.kateinblenden,function(a,s){a!=""&&$("#"+a).show()}),typeof e.installiertgefunden<"u"&&e.installiertgefunden!==null&&(parseInt(e.installiertgefunden)===0?$(".purchases").hide():$(".purchases").show()),typeof e.kaufbargefunden<"u"&&e.kaufbargefunden!==null&&(parseInt(e.kaufbargefunden)===0?$("#no-apps-found").show():$("#no-apps-found").hide()),n.length>0?(t.hide(),t.prev("h2").hide(),i.hide()):(t.show(),t.prev("h2").show(),i.show()))})}
