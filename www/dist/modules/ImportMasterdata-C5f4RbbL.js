var r=function(t){var e={url:{activateJob:"index.php?module=importvorlage&action=list&cmd=activatejob",deleteJob:"index.php?module=importvorlage&action=list&cmd=deletejob",batchJob:"index.php?module=importvorlage&action=list&cmd=batch"},selector:{table:"table#importvorlage_list",deleteIcon:"table#importvorlage_list img.deletejob",activateIcon:"table#importvorlage_list img.activatejob",selectAll:"input#selectall",selectBoxes:"table#importvorlage_list input.select",selectBoxesSelected:"table#importvorlage_list input.select:checked",actionSelect:"select#selaction",actionSend:"input#send"},updateTable:function(){t(e.selector.table).DataTable().ajax.reload()},sendBatch:function(){var a=t(e.selector.selectBoxesSelected);if(t(a).length===0){alert("Bitte Importe auswählen");return}var o=[];t.each(a,function(){o.push(t(this).data("id"))});var c=t(e.selector.actionSelect).val();switch(c){case"delete":if(!confirm("Wirklich löschen?"))return;break;case"activate":if(!confirm("Wirklich aktivieren?"))return;break;default:return}t.ajax({url:e.url.batchJob,method:"post",data:{selection:c,jobIds:o},dataType:"json",success:function(l){e.updateTable()},error:function(l,i,n){console.log(i+" "+n+": "+l.responseText)}})},activateJob:function(a){t.ajax({url:e.url.activateJob,method:"post",data:{jobid:a},dataType:"json",success:function(o){e.updateTable()},error:function(o,c,l){console.log(c+" "+l+": "+o.responseText)}})},deleteJob:function(a){confirm("Wirklich löschen?")&&t.ajax({url:e.url.deleteJob,method:"post",data:{jobid:a},dataType:"json",success:function(o){e.updateTable()},error:function(o,c,l){console.log(c+" "+l+": "+o.responseText)}})},init:function(){t(e.selector.table).on("afterreload",function(){t(e.selector.activateIcon).on("click",function(){e.activateJob(t(this).data("id"))}),t(e.selector.deleteIcon).on("click",function(){e.deleteJob(t(this).data("id"))})}),t(e.selector.selectAll).on("click",function(){t(e.selector.selectBoxes).prop("checked",t(this).prop("checked"))}),t(e.selector.actionSend).on("click",function(){e.sendBatch()})}};return{init:e.init}}(jQuery);$(document).ready(function(){r.init()});
