import{p as F,u as B,r as N,B as $,q as D,A as g,h as e,o as H,l as s,b as i,t as m,x as c,c as I}from"../vue-r8MBkmxb.js";import{A as U}from"../ajaxErrorHandler-BwWU8vup.js";import{r as w}from"../jqueryBridge-CQYx4hBB.js";import{a as y}from"../axios-Cm0UX6qg.js";import{s as T}from"../index.esm-DJL5Ix50.js";import{s as L}from"../dropdown.esm-_2vV7CxE.js";import{c as z}from"../vee-validate.esm-B8KWITsB.js";import{a as C}from"../button.esm-CPeMIqfM.js";import{_ as E}from"../AutoComplete.vue_vue_type_script_setup_true_lang-DW6rzfiE.js";import{b as S}from"../locales.yaml_vue_type_i18n_index_0_src_true_lang-CKrIs7ZX.js";import"../index.esm-CcsjVT0J.js";import"../index.esm-DzkJW0oT.js";import"../index.esm-OnOy6NWm.js";const J=i("h2",null,"Automatisches Label",-1),K={class:"grid gap-1",style:{"grid-template-columns":"25% 75%"}},_=F({__name:"AutomaticLabelEditor",props:{actions:Array,selections:Array},setup(r){var x,h;(x=document.querySelector("a.neubuttonlink"))==null||x.addEventListener("click",()=>o.value=0),(h=document.querySelector("#datatablelabels_automaticlabelslist"))==null||h.addEventListener("click",n=>{if(n.target instanceof Element){let a=n.target.closest("a.datatablelabels-automaticlabeledit");o.value=parseInt((a==null?void 0:a.dataset.id)??"")||null}});const{t:l}=B(),o=N(null),{defineField:u,handleSubmit:q,resetForm:k}=z(),[d]=u("labelname"),[p]=u("action"),[b]=u("selection"),[f]=u("project"),v=q(async n=>{await y.post("index.php?module=datatablelabels&action=automaticlabelsedit&cmd=save",{...n,id:o.value}).catch(U).then(()=>{V(),w()})});$(async()=>{if(!o.value){k();return}await y.post("index.php?module=datatablelabels&action=automaticlabelsedit&cmd=get",{id:o.value}).then(n=>k({values:n.data.data}))});const V=()=>o.value=null;return(n,a)=>(H(),D(e(T),{header:e(l)("common.edit"),visible:o.value!==null,modal:"","onUpdate:visible":V,style:{width:"900px"}},{footer:g(()=>[s(e(C),{label:e(l)("common.cancel").toUpperCase(),onClick:V},null,8,["label"]),s(e(C),{label:e(l)("common.save").toUpperCase(),onClick:e(v)},null,8,["label","onClick"])]),default:g(()=>[i("form",{onSubmit:a[4]||(a[4]=(...t)=>e(v)&&e(v)(...t))},[J,i("div",K,[i("label",null,m(e(l)("label")),1),s(E,{modelValue:e(d),"onUpdate:modelValue":a[0]||(a[0]=t=>c(d)?d.value=t:null),ajaxFilter:"label_type"},null,8,["modelValue"]),i("label",null,m(e(l)("action")),1),s(e(L),{modelValue:e(p),"onUpdate:modelValue":a[1]||(a[1]=t=>c(p)?p.value=t:null),options:r.actions,optionValue:"value",optionLabel:"text"},null,8,["modelValue","options"]),i("label",null,m(e(l)("selection")),1),s(e(L),{modelValue:e(b),"onUpdate:modelValue":a[2]||(a[2]=t=>c(b)?b.value=t:null),options:r.selections,optionValue:"value",optionLabel:"text"},null,8,["modelValue","options"]),i("label",null,m(e(l)("common.project")),1),s(E,{modelValue:e(f),"onUpdate:modelValue":a[3]||(a[3]=t=>c(f)?f.value=t:null),dataKey:"id",optionLabel:t=>[t.abkuerzung,t.name].join(" "),ajaxFilter:"projektname"},null,8,["modelValue","optionLabel"])])],32)]),_:1},8,["header","visible"]))}});typeof S=="function"&&S(_);var A;const M=JSON.parse((A=document.querySelector("#vueapp_props"))==null?void 0:A.textContent);I(_,M).mount("#vueapp");var j;(j=document.querySelector("#datatablelabels_automaticlabelslist"))==null||j.addEventListener("click",async r=>{if(r.target instanceof Element){let l=r.target.closest("a.datatablelabels-automaticlabeldelete");if(l instanceof HTMLElement&&l.dataset.id){if(confirm("Wirklich lÃ¶schen?")===!1)return;await y.post("index.php?module=datatablelabels&action=automaticlabelsedit&cmd=delete",{id:l.dataset.id}).catch(U).then(()=>w())}}});
