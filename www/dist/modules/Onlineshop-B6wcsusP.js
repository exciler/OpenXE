import{p as m,r as f,o as h,q as v,j as g,c as y}from"../vue-DlXmU008.js";import{a as p}from"../axios-Cm0UX6qg.js";import{_ as w}from"../ClickByClickAssistant.vue_vue_type_script_setup_true_lang-BrQzvNRq.js";import{A as T}from"../ajaxErrorHandler-BwWU8vup.js";var x=function(e){var t={selector:{vueAppNewError:"#onlineshop-appnew-error",vueAppNew:"#onlineshop-appnew",vueAppNewJson:"#onlineshop-appnewjson"},initAppNewErrorVue:function(){new Vue({el:t.selector.vueAppNewError,data:{showAssistant:!0,pagination:!0,allowClose:!0,pages:[{type:"defaultPage",icon:"password-icon",headline:"Request ung√ºltig",subHeadline:e(t.selector.vueAppNewError).data("errormsg"),ctaButtons:[{title:"OK",action:"close"}]}]}})},initAppNewVue:function(){new Vue({el:t.selector.vueAppNew,data:{showAssistant:!0,pagination:!0,allowClose:!0,pages:[{type:"form",dataRequiredForSubmit:{data:JSON.stringify(e(t.selector.vueAppNew).data("appnewdata"))},submitType:"submit",submitUrl:"index.php?module=onlineshops&action=appnew&cmd=createdata",headline:e(t.selector.vueAppNew).data("heading"),subHeadline:e(t.selector.vueAppNew).data("info"),form:[{id:0,name:"create-shop",inputs:[{type:"select",name:"shopId",label:"Auswahl",validation:!0,options:JSON.parse(e(t.selector.vueAppNewJson).html())}]}],ctaButtons:[{title:"Weiter",type:"submit",action:"submit"}]}]}})},init:function(){e(t.selector.vueAppNewError).length&&t.initAppNewErrorVue(),e(t.selector.vueAppNew).length&&t.initAppNewVue(),e("#frmappnew").length!==0&&(e("#data").on("paste",function(n){e.ajax({type:"POST",dataType:"json",url:"index.php?module=onlineshops&action=appnew&cmd=checkdata",data:{data:n.originalEvent.clipboardData.getData("text")},success:function(a){e("#msgwrapper").html(a.html)},error:function(a){typeof a.responseJSON<"u"&&e("#msgwrapper").html('<div class="error">'+a.responseJSON.error+"</div>")}})}),e("#data").on("change",function(){e.ajax({type:"POST",dataType:"json",url:"index.php?module=onlineshops&action=appnew&cmd=checkdata",data:{data:e(this).val()},success:function(n){e("#msgwrapper").html(n.html)},error:function(n){typeof n.responseJSON<"u"&&e("#msgwrapper").html('<div class="error">'+n.responseJSON.error+"</div>")}})}))}};return{init:t.init}}(jQuery);$(document).ready(function(){x.init()});var k=function(e){var t={storage:{exampleTemplate:null,treeApi:null,lastTreeSearch:""},openTransformationPopup:function(){e("#textareasmartyincomming").val(e("#transform_cart").val()),e("#textareasmartyincomminginput").val(e("#textareasmartyincomminginput").val())},loadCart:function(n){e("#cart").val()+""!=""&&e.ajax({type:"POST",url:"index.php?module=onlineshops&action=edit&cmd=loadCart",data:{shopid:n,extid:e("#cart").val(),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,content:e("#textareasmartyincomming").val()},success:function(a){e("#textareasmartyincomminginput").val(a.input),e("#dataincommingobject").html(a.object),e("#dataincommingpreview").val(a.preview)}})},initCategoryTree:function(){e("#mlmTree").aciTree({autoInit:!1,checkboxChain:!1,ajax:{url:"index.php?module=onlineshops&action=edit&cmd=loadTree&id="+e("#mlmTree").data("id")},checkbox:!0,multiSelectable:!0,itemHook:function(n,a,o,r){},filterHook:function(n,a,o){if(a.length){var r=this.parent(n);if(r.length){var i=this.getLabel(r);if(o.test(String(i)))return this.setVisible(n),!0;this.setVisible(n)}return o.test(String(this.getLabel(n)))?(n.addClass("searched"),!0):!1}else return!0}}),t.storage.treeApi=e("#mlmTree").aciTree("api"),e("#search").val(""),t.storage.lastTreeSearch="",e("#search").on("keyup",function(){e(this).val()!==t.storage.lastTreeSearch&&(e(".aciTreeLi").removeClass("searched"),t.storage.lastTreeSearch=e(this).val(),api.filter(null,{search:e(this).val(),callback:function(){},success:function(n,a){a.first}}))}),e("#mlmTree").on("acitree",function(n,a,o,r,i){switch(r){case"checked":var l={id:a.getId(o),shopId:e("#mlmTree").data("id"),name:a.getLabel(o),checked:!0,todo:"check"},c=a.getId(o),u=a.children(null,!0,!0);e(u).each(function(){a.getId(e(this))!=c&&a.uncheck(e(this))}),e("#category_root_id").val(c),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=checkTreeNode",data:l,success:function(d){}});break;case"unchecked":var l={id:a.getId(o),shopId:e("#mlmTree").data("id"),name:a.getLabel(o),checked:!1,todo:"uncheck"};e("#category_root_id").val(0),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=uncheckTreeNode",data:l,success:function(d){}});break}}),e("#mlmTree").aciTree("init"),e(window).on("scroll",function(){checkContainerPos()})},initSmarty:function(){e("#editcarttransformation").on("click",function(){t.openTransformationPopup()}),e("#runincomming").on("click",function(){e("#transform_cart").val(e("#textareasmartyincomming").val()),e("#transform_cart_data").val(e("#textareasmartyincomminginput").val()),e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=runincomming",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0},success:function(n){e("#dataincommingobject").html(n.object),e("#dataincommingpreview").val(n.preview)}})}),e("#saveincomming").on("click",function(){e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=savesmartyincomming",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,active:e("#transferactive").prop("checked")?"1":"0"},success:function(){e("#transform_cart_format").val(e("#smartyinputtype").val()),e("#transform_cart_replace").val(e("#replacecart").prop("checked")?1:0),e("#transform_cart").val(e("#textareasmartyincomming").val()),e("#transform_cart_data").val(e("#textareasmartyincomminginput").val()),e("#transform_cart_active").val(e("#transferactive").prop("checked")?"1":"0")}})}),e("#transferactive").on("change",function(){e("#transform_cart_active").val(e("#transferactive").prop("checked")?"1":"0")}),e("#smartyinputtype").on("change",function(){t.loadDefaultTemplate()}),t.loadDefaultTemplate(),e("#loadDefaultTemplate").on("click",function(){t.storage.loadDefaultTemplate+""!=""&&((e("#textareasmartyincomming").val()+"").trim()!==""&&!confirm("Das bisherige Template wird ersetzt. Fortfahren?")||e("#textareasmartyincomming").val(t.storage.loadDefaultTemplate))}),e("#loadCart").on("click",function(){var n=e("#cart").val()+"";n!==""&&t.loadCart(e(this).data("shopid"))})},loadDefaultTemplate:function(){t.storage.loadDefaultTemplate="",e.ajax({url:"index.php?module=onlineshops&action=edit&cmd=loadDefaultTemplate",type:"POST",dataType:"json",data:{content:e("#textareasmartyincomming").val(),input:e("#textareasmartyincomminginput").val(),shopid:e("#loadCart").data("shopid"),format:e("#smartyinputtype").val(),replacecart:e("#replacecart").prop("checked")?1:0,active:e("#transferactive").prop("checked")?"1":"0"},success:function(n){typeof n.template<"u"&&n.template!==""?(t.storage.loadDefaultTemplate=n.template,e("#loadDefaultTemplate").toggleClass("hidden",!1),e("#loadDefaultTemplate").show()):(t.storage.loadDefaultTemplate="",e("#loadDefaultTemplate").hide())}})},init:function(){e("#smartyinput").length&&t.initSmarty(),e("#mlmTree").length&&t.initCategoryTree()}};return{init:t.init}}(jQuery);$(document).ready(function(){k.init()});const b=m({__name:"App",setup(e){const t=f(null);document.querySelectorAll(".createbutton").forEach(r=>{r.addEventListener("click",a)});const n=document.querySelector(".autoOpenModule");n&&n.dataset.module&&o(n.dataset.module);function a(r){const i=r.currentTarget.dataset.module;i&&o(i)}function o(r){p.post("index.php?module=onlineshops&action=create&cmd=getassistant",{shopmodule:r},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(i){if(i.data.pages===void 0&&i.data.location!==void 0){window.location=i.data.location;return}t.value=i.data.pages}).catch(T)}return(r,i)=>t.value?(h(),v(w,{key:0,pages:t.value,pagination:"",allowClose:"",onClose:i[0]||(i[0]=c=>t.value=null)},null,8,["pages"])):g("",!0)}});function S(e){const t=e.currentTarget.value,n={headers:{"Content-Type":"application/x-www-form-urlencoded"}};p.post("index.php?module=onlineshops&action=create&cmd=suche",{val:t},n).then(a=>{a.data!==void 0&&a.data!=null&&(a.data.ausblenden!==void 0&&a.data.ausblenden!=null&&a.data.ausblenden.forEach(o=>{const r=document.querySelector("#"+o);r&&(r.style.display="none")}),typeof a.data.anzeigen!==void 0&&a.data.anzeigen!=null&&a.data.anzeigen.forEach(o=>{const r=document.querySelector("#"+o);r&&(r.style.display="flex")}))})}var s;(s=document.querySelector("#suche"))==null||s.addEventListener("keyup",S);y(b,{}).mount("#onlineshop-create");
