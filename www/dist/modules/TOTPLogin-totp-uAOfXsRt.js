var i=function(e){var n={storage:{qrDiv:null,secret:null},init:function(){e(document).ready(function(){let t=e("#totp_enable");t.length>0&&(t[0].onclick=n.handleOnClickEnable);let l=e("#totp_disable");l.length>0&&(l[0].onclick=n.handleOnClickDisable)})},handleOnClickDisable:function(){e.post("index.php?module=totp&action=disable",{action:"disable"},n.handleDisablePOST)},handleOnClickEnable:function(){e("#dialog-confirm").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:[{text:"Abbrechen",click:function(){e(this).dialog("close")},class:"button button-secondary"},{text:"Ich habe den Code gescannt!",click:function(){e(this).dialog("close"),e.post("index.php?module=totp&action=enable",{secret:n.storage.secret},n.handleEnablePOST)},class:"button button-primary"}]}),e(".ui-button-text").removeClass(),e.get("index.php?module=totp&action=generate",n.handleSecretGenerateGET)},handleSecretGenerateGET:function(t,l){if(l!=="success"){alert("Leider ist etwas schief gelaufen");return}e("#div_qr").html(t.qr),n.storage.secret=t.secret},handleEnablePOST:function(t,l){if(l!=="success"){alert("Fehlgeschlagen: "+t.msg);return}location.reload()},handleDisablePOST:function(t,l){if(l!=="success"){alert("Fehlgeschlagen: "+t.msg);return}location.reload()}};return{init:n.init}}(jQuery);i.init();
